Code gererated by chatgpt (thanks to him)